categories: Note

tags:

- Web
- JS

date: 2017-11-16

toc: true

title: ç§»åŠ¨ç«¯é€†è¢­ï¼iPad çš„ JavaScript æ€§èƒ½å·²è¶…è¶Š rMBP
---

è¯´åˆ°ç§»åŠ¨ç«¯ï¼Œå¾ˆå¤šåŒå­¦çš„å°è±¡å¯èƒ½è¿˜åœç•™åœ¨ã€å…¼å®¹è´¹åŠ²ã€è´¹æ€§èƒ½åŠ¨ç”»ã€ä¸å¥½è°ƒè¯•ã€‘çš„é˜¶æ®µã€‚ä½†è‹¹æœæ¯å¹´å‘å¸ƒä¼šçš„ã€è¿„ä»Šæœ€å¼ºã€‘éš¾é“éƒ½æ˜¯åœ¨æŒ¤ç‰™è†å—ï¼Ÿç¬”è€…åšäº†ä¸ªå‰ç«¯é¢†åŸŸå†…çš„æ€§èƒ½å¯¹æ¯”è¯„æµ‹ï¼Œç»“æœéå¸¸æœ‰è¶£ã€‚

<!--more-->

## æ€è·¯
åœ¨å‰ç«¯èŒƒç•´å†…ï¼Œå¯¹ã€æ€§èƒ½ã€‘çš„è¿½æ±‚ä¸€èˆ¬å‡ºç°åœ¨èµ„æºåŠ è½½é€Ÿåº¦ã€å‡å°‘é‡å¤æ¸²æŸ“ç­‰å±‚é¢ï¼Œè€Œå¯¹äº JavaScript è¯­è¨€æœ¬èº«çš„æ‰§è¡Œé€Ÿåº¦å…³æ³¨ç›¸å¯¹è¾ƒå°‘ã€‚ä½† JavaScript çš„æ‰§è¡Œé€Ÿåº¦ï¼Œåˆå’Œè®¾å¤‡çš„æ€§èƒ½ä¹ƒè‡³ç”¨æˆ·ä½“éªŒå­˜åœ¨ç€å¾ˆå¼ºçš„å…³è”æ€§ï¼š

1. JS å•çº¿ç¨‹å¼‚æ­¥éé˜»å¡çš„æ¨¡å¼ï¼Œå¤©ç”Ÿè€ƒéªŒå•æ ¸æ€§èƒ½ã€‚
2. JS è¿è¡Œæ—¶å¤©ç”Ÿè·¨å¹³å°ï¼Œç”¨äºè¯„æµ‹çš„ç®—æ³•ä»£ç åœ¨æ‰€æœ‰å¹³å°ä¸Šéƒ½æ˜¯åŒä¸€ä»½ï¼Œä¸åƒ GeekBench å¯èƒ½ä¼šåœ¨ä¸åŒå¹³å°è¿›è¡Œä¸åŒçš„ç¼–è¯‘ä¼˜åŒ–ã€‚
3. åœ¨æ¯ä¸ªå¹³å°ï¼Œæµè§ˆå™¨éƒ½æ˜¯é‡åº¦ä¼˜åŒ–çš„æ€æ‰‹çº§åº”ç”¨ï¼Œèƒ½å……åˆ†åˆ©ç”¨è®¾å¤‡ç¡¬ä»¶æ€§èƒ½ã€‚
4. JS çš„æ‰§è¡Œé€Ÿåº¦ç›´æ¥å…³ç³»åˆ° Web æµè§ˆä½“éªŒçš„æµç•…åº¦ã€‚ä¸ä»…æ˜¯æ¡Œé¢ç«¯çš„ Electronï¼Œè®¸å¤šç§»åŠ¨ç«¯åŸç”Ÿåº”ç”¨ä¹Ÿå·²ç»é‡åº¦ä¾èµ– WebViewã€Hybrid æˆ– Bridge æ–¹æ¡ˆã€‚

æ‰€ä»¥ï¼Œä¸‹é¢çš„åŸºç¡€æ€è·¯å°±æ˜¯ï¼šåœ¨ä¸åŒçš„è®¾å¤‡ä¸Šè¿è¡ŒåŒæ ·çš„ JavaScript è¯„æµ‹ä»£ç ï¼Œæ ¹æ®æ‰§è¡Œé€Ÿåº¦æ¥å¯¹å®ƒä»¬çš„æ€§èƒ½åšå‡ºè¯„ä»·ã€‚

## æµ‹è¯•æ–¹å¼
å‚ä¸çš„è®¾å¤‡æ€»å…±ä¸‰ä¸ªï¼ˆè´«ç©·é™åˆ¶äº†æˆ‘çš„æƒ³è±¡ï¼‰ï¼š

* 13 å¯¸ Retina MacBook Pro 2015ï¼Œi5 + 8G RAM
* iPad Pro 10.5 å¯¸ï¼ŒA10X + 4G RAM
* iPhone SEï¼ŒA9 + 2G RAM

é‡‡ç”¨çš„æµ‹è¯•ä»£ç ä¸€å…±ä¸‰å¥—ï¼š

* Webkit å›¢é˜Ÿå‡ºå“çš„ [SunSpider](https://webkit.org/perf/sunspider/sunspider.html) æµ‹è¯•
* Chromium å›¢é˜Ÿå‡ºå“çš„ [Octane 2.0](http://chromium.github.io/octane/) æµ‹è¯•
* JSPerf çš„ [DOM æ“ä½œ](jsperf.com/javascript-dom-benchmark) æµ‹è¯•

æµè§ˆå™¨å¹³å°ä¸€å…±ä¸‰ä¸ªï¼š

* macOS 10.13 + Safari 11.0.2
* macOS 10.13 + Chrome 62
* iOS 11.1 + mobile Safariï¼ˆiPhone å’Œ iPad ç‰ˆæœ¬ç›¸åŒï¼‰

## æµ‹è¯•ç»“æœ

### SunSpider æœå…”å…”
å®‰å…”å…”è·‘åˆ†å¹¿å—è¯Ÿç—…çš„ä¸€ç‚¹ï¼Œåœ¨äºå®ƒæ¥æ”¶äº†æŸäº›æ‰‹æœºå‚å•†çš„æŠ•èµ„è€Œéš¾ä»¥ä¿è¯å…¬æ­£æ€§ã€‚åœ¨å‰ç«¯é¢†åŸŸè¿™æ˜¯ä¸å­˜åœ¨çš„ï¼Œå› ä¸ºæ‰€æœ‰çš„ä¸»æµæ€§èƒ½æµ‹è¯•éƒ½æ˜¯æµè§ˆå™¨å‚å•†è€Œä¸æ˜¯æ‰‹æœºå‚å•†ç»´æŠ¤çš„â€¦SunSpider å°±æ˜¯ Webkit å‡ºå“çš„è€ç‰Œæµ‹è¯•ï¼ŒåŒ…å«åŠ è§£å¯†ã€æ•°æ®ç»“æ„ã€ä½è¿ç®—ã€æ­£åˆ™ç­‰å¸¸è§æ“ä½œã€‚é‰´äº Webkit å’Œè‹¹æœçš„å…³ç³»ï¼ŒæŠŠå®ƒå«åšæœå…”å…”ä¹Ÿä¸ä¸ºè¿‡ã€‚æµ‹è¯•ç»“æœæˆªå›¾å¦‚ä¸‹ï¼š

![chart-sunspider](http://7u2gqx.com1.z0.glb.clouddn.com/mobile-js-benchmark-chart.001.jpeg)

ç¬¬ä¸€åæ˜¯ iPad Proï¼Œç¬¬äºŒåæ˜¯ rMBPï¼Œæœ€åæ˜¯ iPhone SEã€‚çœ‹èµ·æ¥ Chrome åœ¨è¿™é¡¹è¯„æµ‹ä¸­æ€§èƒ½æ„å¤–çš„ä½ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿç”±äº SunSpider æœ¬èº«çš„ micro benchmark æ–¹å¼è¢« Google å›¢é˜Ÿè®¤ä¸ºå·²ç»ä¸åŒ¹é… JS å¼•æ“çš„ä¼˜åŒ–æœºåˆ¶ï¼Œå› è€Œä»–ä»¬æ”¾å¼ƒäº† SunSpiderï¼Œè½¬è€Œå¼€å‘å‡ºäº†è‡ªå·±çš„ Octaneã€‚

### Octane è°·å…”å…”
Chromium å›¢é˜Ÿç»´æŠ¤çš„ Octane ä¹Ÿç®—æ˜¯è°·æ­Œäº²å„¿å­äº†ã€‚å®ƒé™¤äº†æ•°å­¦è¿ç®—å¤–ï¼Œè¿˜åŠ å…¥äº†ä¸å°‘ç¼–è¯‘ã€CPU æ¨¡æ‹Ÿã€GC æ€§èƒ½æ–¹é¢çš„æŒ‡æ ‡ã€‚æˆ‘ä»¬çœ‹çœ‹è¿™ä¸ªè¯„æµ‹çš„ç»“æœï¼š

![chart-octane](http://7u2gqx.com1.z0.glb.clouddn.com/mobile-js-benchmark-chart.002.jpeg)

iPad Pro ç»§ç»­é¢†è·‘ï¼ŒrMBP Chrome çš„åˆ†æ•°æ˜æ˜¾é è°±äº†å¾ˆå¤šï¼Œä½†ç¦»æ¡Œé¢ç‰ˆ Safari è¿˜æœ‰è·ç¦»ã€‚iPhone SE ä¾æ—§è·¯äººâ€¦

å€¼å¾—ä¸€æçš„æ˜¯ï¼Œåœ¨ TypeScript ç¼–è¯‘çš„å•é¡¹æµ‹è¯•ä¸­ï¼ŒiPad Pro çš„æˆç»©è¾¾åˆ°äº† rMBP çš„è¿‘ä¸¤å€ï¼è¿™ä¸å°±æ˜¯åº“å…‹åå¤å¼ºè°ƒçš„ç”Ÿäº§åŠ›å·¥å…·å—ï¼æƒ³è±¡ä¸€ä¸‹æ‹¿ Mac æ„å»ºå‰ç«¯é¡¹ç›®ï¼Œé€Ÿåº¦è¿˜èµ¶ä¸ä¸Šå¹³æ¿çš„æ„Ÿè§‰å§ğŸ˜€

### JSPerf è„å…”å…”
ä¸Šé¢çš„å‡ ä¸ªè¯„æµ‹æŒ‡æ ‡æœ‰ä¸ªå…±åŒçš„é—®é¢˜ï¼Œå°±æ˜¯åªå…³æ³¨ JavaScript è¯­è¨€æœ¬èº«çš„æ‰§è¡Œé€Ÿåº¦ï¼Œå’Œ DOM æ¸²æŸ“è¿™ç§æ¯”è¾ƒã€è„ã€‘ä½†æ˜¯åˆå’Œç”¨æˆ·ä½“éªŒæ¯æ¯ç›¸å…³çš„å†…å®¹ç›¸æ¯”ï¼ŒåŒºåˆ†åº¦å¯èƒ½è¿˜ä¸å¤Ÿå¼ºã€‚å› æ­¤æˆ‘ä»¬åœ¨ JSPerf ä¸Šåšäº†ä¸€ä¸ªç®€å•çš„ DOM æ“ä½œæµ‹è¯•ï¼š

![chart-dom](http://7u2gqx.com1.z0.glb.clouddn.com/mobile-js-benchmark-chart.003.jpeg)

çœ‹èµ·æ¥è°·æ­Œåˆä¸€æ¬¡è´Ÿä¼˜åŒ–äº†â€¦â€¦ä¸è¿‡ `iPad Pro > rMBP > iPhone SE` çš„é¡ºåºä»ç„¶å‡†ç¡®ã€‚

## æ€»ç»“
æ ¹æ®ä¸Šé¢çš„æµ‹è¯•ç»“æœï¼Œæˆ‘ä»¬èƒ½å¤Ÿå¾—å‡ºçš„ç»“è®ºæ˜¯ï¼š**iPad Pro çš„ Mobile Safariï¼Œå…¶ JavaScript æ€§èƒ½ç¡®å®æ¯” 2015 æ¬¾ rMBP çš„ Chrome å’Œ Safari è¦å¼ºã€‚**è¯·æ³¨æ„ï¼Œè¿™ä¸ªç»“è®ºæ˜¯æœ‰ä¸¥æ ¼çš„é™åˆ¶æ¡ä»¶çš„ã€‚å¦‚æœè°æŠŠè¿™ä¸ªç»“è®ºç²—æš´åœ°ç®€åŒ–æˆã€iPad åŠæ‰“ Macã€‘ç„¶åæ‰¹åˆ¤ä¸€ç•ªï¼Œé‚£ä¹ˆä»–ä¸æ˜¯è ¢å°±æ˜¯åã€‚

è¿™ä¸ªç»“æœä¹Ÿèƒ½å¤Ÿåé©³ä¸å°‘è§‚ç‚¹ã€‚æ¯”å¦‚ï¼Œå¾ˆå¤šäººæ‰€è®¤ä¸ºçš„ã€GeekBench é‡Œ iOS è·‘åˆ†è¶…è¶Š Mac æ˜¯çº¯ç²¹æ‰¯æ·¡ã€‘çš„è§‚ç‚¹å¯èƒ½éœ€è¦é‡æ–°è€ƒé‡äº†ã€‚å¦å¤–ã€æ¶æ„ä¸åŒä¸å…·å¯æ¯”æ€§ã€‘çš„è¯´æ³•æ›´æ˜¯ç«™ä¸ä½è„šï¼Œæ¯•ç«Ÿå°±ç®—æ¶æ„ä¸åŒï¼Œè·‘çš„ JavaScript ä»£ç ã€æ‰“å¼€çš„ç½‘é¡µå¯éƒ½æ˜¯å®Œå…¨ç›¸åŒçš„å•Šã€‚å¦‚æœæˆ‘ä»¬æ‰“å¼€åŒæ ·çš„é¡µé¢ï¼ŒiPad è·‘çš„æ¯” Mac å¿«ï¼Œè¿™å°±å’Œæ¶æ„æ— å…³ï¼Œæ˜¯å®æ‰“å®å¯è¡¡é‡çš„ä½“éªŒå·®è·äº†ã€‚

å¦‚æœä½ åšæŒã€è·‘åˆ†ä¸ä»£è¡¨ä½“éªŒã€‘ï¼Œé‚£ä¹ˆä¸å¦¨æ€è€ƒä¸‹ï¼šä¸€ä¸ªäººçš„é«˜è€ƒæˆç»©å’Œç‰›é€¼ç¨‹åº¦æœ‰æ²¡æœ‰ç›¸å…³æ€§å‘¢ï¼Ÿè¿™ä¸ªè¯é¢˜å¤ªå¤§ï¼Œåœ¨è¿™é‡Œä¸åšå±•å¼€ã€‚å°±äº‹è®ºäº‹åœ°è¯´ï¼Œè·‘åˆ†å’Œé«˜è€ƒä½œä¸ºä¸€ç§å°†é«˜ç»´ä½“éªŒæ‹å¹³ä¸ºå•ç»´åº¦åˆ†æ•°çš„è¯„ä»·ä½“ç³»ï¼Œå½“ç„¶ä¼šå­˜åœ¨å®¢è§‚æ€§çš„é—®é¢˜ã€‚ä¸è¿‡ï¼Œå°±åƒé«˜è€ƒæ”¹é©æ˜¯ä¸ºäº†æ›´å¥½åœ°ç­›é€‰å‡ºäººæ‰ä¸€æ ·ï¼Œ[æµè§ˆå™¨å‚å•†ä¹Ÿåœ¨æ”¹è¿›è·‘åˆ†çš„æœºåˆ¶](https://v8project.blogspot.com/2017/04/retiring-octane.html)ã€‚

å½“ç„¶ï¼Œæœ¬æ–‡çš„æµ‹è¯•æ˜¾ç„¶æ˜¯å­˜åœ¨ä¸å°‘é—®é¢˜ï¼Œä½œè€…èƒ½æƒ³åˆ°çš„å°±åŒ…æ‹¬ï¼š

* SunSpider å’Œ Octane å·²ç»é€æ¸è¢«æµè§ˆå™¨å‚å•†è®¤ä¸ºè¿‡äºã€åº”è¯•æ•™è‚²ã€‘ï¼Œå’ŒçœŸå®ä¸–ç•Œå­˜åœ¨å·®å¼‚ï¼Œå› æ­¤ç¦»çœŸå®ä½“éªŒè¿˜æœ‰å·®è·ï¼ˆChromium å›¢é˜Ÿæ­£åœ¨æ¨è¿›æ›´èƒ½è¡¡é‡æ—¥å¸¸ä½“éªŒçš„æ–¹æ¡ˆï¼Œæ˜¯ä¸æ˜¯å’Œã€ç´ è´¨æ•™è‚²ã€‘æœ‰ç‚¹åƒå‘¢ï¼‰ã€‚
* æ²¡æœ‰å®‰å“å’Œ Windowsï¼Œæ›´æ²¡æœ‰ iPhone Xï¼ˆå†è¯´ä¸€éï¼Œè´«ç©·é™åˆ¶äº†æˆ‘çš„æƒ³è±¡ï¼‰ã€‚
* æ²¡æœ‰å„ç§é‡å¤å–å‡å€¼ï¼Œç»“æœæœªå¿…å‡†ç¡®ã€‚

ä¸è¿‡ï¼Œä»ä¸€äº›ç‰¹æ®Šç»´åº¦å‡ºå‘æ‰€åšçš„è¯„æµ‹ï¼Œå…¶å®æ˜¯éå¸¸æœ‰è¶£çš„ã€‚è¿™ç¯‡æ–‡ç« æœ¬èº«ä¹Ÿå¤šå°‘å—äº†ç¬”è€…å‰æ–‡ [åŸºäºæ–‡æœ¬ç›¸ä¼¼åº¦ç®—æ³•ï¼Œåˆ†æ Vue æ˜¯æŠ„å‡ºæ¥çš„æ¡†æ¶å—ï¼Ÿ](https://juejin.im/post/5985abf9f265da3e345f4f97)çš„å¯å‘ã€‚è¿™æ ·çš„æ–‡ç« å¹¶ä¸ä¸€å®šèƒ½ä¿è¯ç»å¯¹çš„å‡†ç¡®ä¸å…¬æ­£ï¼Œä½†ä»æ–°çš„è§†è§’æ¥çœ‹é—®é¢˜ï¼Œæ‰€å¾—åˆ°çš„ç»“è®ºå¤šåŠä¼šå¾ˆæœ‰è¶£å“¦ã€‚

ä¸‹é¢ç»™å‡ºæ–‡ä¸­æ‰€æ¶‰åŠçš„å†…å®¹å‚è€ƒï¼š

### è¯„æµ‹æ•°æ®
è¿™æ˜¯ç»˜åˆ¶æ–‡ä¸­å›¾è¡¨æ•°æ®æ‰€å¯¹åº”çš„æˆªå›¾ï¼š

#### SunSpider
* [sunspider-ipp](http://7u2gqx.com1.z0.glb.clouddn.com/sunspider-ipp.PNG)
* [sunspider-rmbp-safari](http://7u2gqx.com1.z0.glb.clouddn.com/sunspider-rmbp-safari.png)
* [sunspider-rmbp-chrome](http://7u2gqx.com1.z0.glb.clouddn.com/sunspider-rmbp-chrome.png)
* [sunspider-se](http://7u2gqx.com1.z0.glb.clouddn.com/sunspider-se.PNG)

#### Octane
* [octane-ipp](http://7u2gqx.com1.z0.glb.clouddn.com/octane-ipp.PNG)
* [octane-rmbp-chrome](http://7u2gqx.com1.z0.glb.clouddn.com/octane-chrome.png)
* [octane-rmbp-safari](http://7u2gqx.com1.z0.glb.clouddn.com/octane-safari.png)
* [octane-se](http://7u2gqx.com1.z0.glb.clouddn.com/octane-se.PNG)

#### JSPerf
* [jsperf-ipp](http://7u2gqx.com1.z0.glb.clouddn.com/dom-ipp.png)
* [jsperf-rmbp-chrome](http://7u2gqx.com1.z0.glb.clouddn.com/dom-chrome.png)
* [jsperf-rmbp-safari](http://7u2gqx.com1.z0.glb.clouddn.com/dom-safari.png)
* [jsperf-se](http://7u2gqx.com1.z0.glb.clouddn.com/dom-se.png)

### æµ‹è¯•åœ°å€
è¿™äº›è¯„æµ‹ä»£ç åªè¦ç‚¹å¼€é“¾æ¥å°±èƒ½ç›´æ¥è·‘å“¦ï¼Œæ¬¢è¿å£•ä»¬åœ¨è¯„è®ºé‡Œæ™’å‡ºè‡ªå·±ç‰›é€¼è®¾å¤‡çš„åˆ†æ•°ï¼

* [SunSpider](https://webkit.org/perf/sunspider/sunspider.html)
* [Octane 2.0](http://chromium.github.io/octane/)
* [JSPerf](jsperf.com/javascript-dom-benchmark)

æœ€åï¼Œçœ‹äº†è¿™äº›æœå…”å…”ã€è°·å…”å…”å’Œè„å…”å…”çš„è¯„æµ‹ï¼Œæœ‰æ²¡æœ‰æ³¨æ„åˆ°ä½œè€…çš„å¤´åƒä¹Ÿæ˜¯å…”å…”å‘¢ï¼Œ[æ¬¢è¿å…³æ³¨å•Š](https://github.com/doodlewind)ï¼ˆæ‹–èµ°ï¼‰
